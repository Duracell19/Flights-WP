<views:MvxWindowsPage
    x:Class="Flights.WP.Views.MainPageView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:MvvmCross.WindowsCommon.Views"
    mc:Ignorable="d"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    NavigationCacheMode="Required">

    <Pivot SelectedIndex="{Binding Properties.PivotNumber, Mode=TwoWay}">
        <i:Interaction.Behaviors>
            <core:EventTriggerBehavior EventName="SelectionChanged">
                <core:InvokeCommandAction Command ="{Binding Commands.SetTheVisibilityIconCommand}"/>
            </core:EventTriggerBehavior>
        </i:Interaction.Behaviors>

        <PivotItem Header="Entry">
            <Grid HorizontalAlignment="Center">
                <ScrollViewer>
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="From" 
                                       Style="{StaticResource TextBlockEntryStyle}"/>
                            <ComboBox SelectedItem="{Binding Properties.TextCountryFrom, Mode=TwoWay}" 
                                      ItemsSource="{Binding Properties.CountriesFrom}" 
                                      Style="{StaticResource ComboBoxStyle}"
                                      PlaceholderText="Choose country">
                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:InvokeCommandAction Command="{Binding Commands.SelectCountryFromCommand}"/>
                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ComboBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Style="{StaticResource TextBlockEntryStyle}"/>
                            <ComboBox SelectedItem="{Binding Properties.TextCityFrom, Mode=TwoWay}" 
                                      ItemsSource="{Binding Properties.CitiesFrom}" 
                                      Style="{StaticResource ComboBoxStyle}"
                                      PlaceholderText="{Binding  Properties.PlaceholderTextCityFrom}" 
                                      IsEnabled="{Binding Properties.IsEnabledCityFrom}">
                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:InvokeCommandAction Command="{Binding Commands.SelectCityFromCommand}"/>
                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ComboBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="To" 
                                       Style="{StaticResource TextBlockEntryStyle}"/>
                            <ComboBox SelectedItem="{Binding Properties.TextCountryTo, Mode=TwoWay}" 
                                      ItemsSource="{Binding Properties.CountriesTo}" 
                                      Style="{StaticResource ComboBoxStyle}" 
                                      PlaceholderText="Choose country">
                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:InvokeCommandAction Command="{Binding Commands.SelectCountryToCommand}"/>
                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ComboBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Style="{StaticResource TextBlockEntryStyle}"/>
                            <ComboBox SelectedItem="{Binding Properties.TextCityTo, Mode=TwoWay}" 
                                      ItemsSource="{Binding Properties.CitiesTo}" 
                                      Style="{StaticResource ComboBoxStyle}" 
                                      PlaceholderText="{Binding Properties.PlaceholderTextCityTo}" 
                                      IsEnabled="{Binding Properties.IsEnabledCityTo}">
                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:InvokeCommandAction Command="{Binding Commands.SelectCityToCommand}"/>
                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ComboBox>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Style="{StaticResource TextBlockEntryStyle}" 
                                       Width="210"/>
                            <TextBlock Text="Choose data" 
                                       Style="{StaticResource TextBlockEntryStyle}" 
                                       Width="148"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton IsChecked="{Binding Properties.IsCheckedOneWay, Mode=TwoWay}" 
                                         Command="{Binding Commands.SetOneWayCommand}" 
                                         Content="One way" 
                                         Style="{StaticResource RadioButtonStyle}"/>
                            <DatePicker Date="{Binding Properties.DateOneWay, Mode=TwoWay}" 
                                        IsEnabled="true" 
                                        Style="{StaticResource DatePickerStyle}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton IsChecked="{Binding Properties.IsCheckedReturn, Mode=TwoWay}" 
                                         Command="{Binding Commands.SetReturnWayCommand}" 
                                         Content="Return" Style="{StaticResource RadioButtonStyle}"/>
                            <DatePicker Date="{Binding Properties.DateReturn, Mode=TwoWay}" 
                                        IsEnabled="{Binding Properties.IsEnabledDateReturn, Mode=TwoWay}" 
                                        Style="{StaticResource DatePickerStyle}"/>
                        </StackPanel>
                        <Button IsEnabled="{Binding Properties.IsEnabledButtonFind, Mode=TwoWay}" 
                                Content="Find flights" Style="{StaticResource ButtonStyle}" 
                                Command="{Binding Commands.FindFlightsCommand}"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </PivotItem>

        <PivotItem Header="Favorites">
            <Grid HorizontalAlignment="Center">
                <ListView Name="favoriteList" 
                          ItemsSource="{Binding Properties.FavoriteList}">
                    <i:Interaction.Behaviors>
                        <core:EventTriggerBehavior EventName="SelectionChanged">
                            <core:InvokeCommandAction Command="{Binding  Commands.SetFlightCommand}" 
                                                      CommandParameter="{Binding ElementName=favoriteList, Path=SelectedItem}"/>
                        </core:EventTriggerBehavior>
                    </i:Interaction.Behaviors>
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel x:ConnectionId='1'                           >
                                <FlyoutBase.AttachedFlyout>
                                    <MenuFlyout>
                                        <MenuFlyoutItem x:ConnectionId='2' Text="Delete" 
                                                                             />
                                    </MenuFlyout>
                                </FlyoutBase.AttachedFlyout>
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="ms-appx:///Assets/favorite.png" 
                                           Height="35" 
                                           Width="35"/>
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CountryFrom}" 
                                                       FontSize="18" 
                                                       Padding="10" 
                                                       Foreground="#FF959595"/>
                                            <Image Source="ms-appx:///Assets/direction.png"  
                                                   Height="13" 
                                                   Width="13"/>
                                            <TextBlock Text="{Binding CountryTo}"
                                                       FontSize="18" 
                                                       Padding="10"
                                                       Foreground="#FF959595"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CityFrom}"
                                                       FontSize="15" 
                                                       Padding="10" 
                                                       Foreground="#FF959595"/>
                                            <Image Source="ms-appx:///Assets/direction.png"  
                                                   Height="13"
                                                   Width="13"/>
                                            <TextBlock Text="{Binding CityTo}" 
                                                       FontSize="15" 
                                                       Padding="10" 
                                                       Foreground="#FF959595"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </PivotItem>

        <PivotItem Header="About">
            <Grid HorizontalAlignment="Center">
                <ScrollViewer>
                    <Grid>
                        <TextBlock Text="{Binding Properties.TextAbout}" 
                                   Style="{StaticResource TextBlockAboutStyle}"/>
                    </Grid>
                </ScrollViewer>
            </Grid>
        </PivotItem>

    </Pivot>

    <Page.BottomAppBar>
        <CommandBar>
            <AppBarButton Visibility="{Binding Properties.VisibilityClear, Converter={StaticResource SetVisibilityIcon}}"  
                          Label="Clear" 
                          Icon="Clear" 
                          Command="{Binding Commands.ClearFieldsCommand}"/>
            <AppBarButton Visibility="{Binding Properties.VisibilityRefresh, Converter={StaticResource SetVisibilityIcon}}" 
                          Label="Refresh"
                          Icon="Refresh" 
                          Command="{Binding Commands.UpdateFavoriteListCommand}"/>
            <AppBarButton Label="Help" 
                          Icon="Help" 
                          Command="{Binding Commands.ShowHelpInformationCommand}"/>
        </CommandBar>
    </Page.BottomAppBar>
    
</views:MvxWindowsPage>

